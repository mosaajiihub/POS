# Vulnerability Management System

## Overview

The Vulnerability Management System provides comprehensive security scanning and vulnerability tracking capabilities for the Mosaajii POS system. It includes dependency scanning, CI/CD security integration, and container/infrastructure security assessment.

## Features

### 1. Dependency Vulnerability Scanning
- Automated scanning of npm dependencies
- Integration with npm audit and external vulnerability databases
- Vulnerability severity assessment and prioritization
- Remediation tracking and management

### 2. CI/CD Security Integration
- Security gates for build pipelines
- Automated security testing integration
- Deployment blocking for critical vulnerabilities
- Security artifact generation

### 3. Container and Infrastructure Security
- Container image vulnerability scanning
- Infrastructure configuration validation
- Kubernetes security policy enforcement
- Cloud resource security assessment

## API Endpoints

### Dependency Scanning
- `POST /api/vulnerability/scan/dependencies` - Scan project dependencies
- `GET /api/vulnerability/stats` - Get vulnerability statistics
- `POST /api/vulnerability/schedule-scan` - Schedule automated scans

### Vulnerability Management
- `GET /api/vulnerability/:id` - Get vulnerability details
- `PUT /api/vulnerability/:id/status` - Update vulnerability status
- `GET /api/vulnerability/:id/remediation` - Track remediation progress

### CI/CD Integration
- `POST /api/vulnerability/cicd/validate-gates` - Validate security gates
- `POST /api/vulnerability/cicd/check-deployment` - Check deployment blocking
- `POST /api/vulnerability/cicd/generate-artifacts` - Generate security artifacts
- `GET /api/vulnerability/cicd/security-gates/default` - Get default gates
- `PUT /api/vulnerability/cicd/security-gates/:id` - Update security gate

### Container Security
- `POST /api/vulnerability/container/scan` - Scan container image
- `POST /api/vulnerability/infrastructure/validate` - Validate infrastructure
- `POST /api/vulnerability/kubernetes/enforce-policies` - Enforce K8s policies
- `POST /api/vulnerability/cloud/assess` - Assess cloud resources

## Configuration

### Security Gates
Default security gates include:
- Dependency vulnerability scan (max 0 critical, 5 high vulnerabilities)
- Static application security testing (max 0 critical, 3 high issues)
- Secrets detection (no secrets allowed)

### Automated Scanning
- Default schedule: Daily at 2 AM (`0 2 * * *`)
- Configurable via cron expressions
- Automatic alerting for critical vulnerabilities

## Usage Examples

### Scan Dependencies
```bash
curl -X POST http://localhost:3001/api/vulnerability/scan/dependencies \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <token>" \
  -d '{"projectPath": "/path/to/project"}'
```

### Update Vulnerability Status
```bash
curl -X PUT http://localhost:3001/api/vulnerability/vuln-123/status \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <token>" \
  -d '{"status": "FIXED", "notes": "Updated dependency to secure version"}'
```

### Validate CI/CD Security Gates
```bash
curl -X POST http://localhost:3001/api/vulnerability/cicd/validate-gates \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <token>" \
  -d '{
    "id": "pipeline-123",
    "name": "main-build",
    "branch": "main",
    "commit": "abc123",
    "securityGates": [...]
  }'
```

## Security Considerations

1. **Access Control**: All endpoints require authentication and appropriate role permissions
2. **Input Validation**: All inputs are validated and sanitized
3. **Rate Limiting**: API endpoints are rate-limited to prevent abuse
4. **Audit Logging**: All security operations are logged for audit purposes
5. **Data Protection**: Vulnerability data is encrypted and access-controlled

## Integration

### CI/CD Pipeline Integration
```yaml
# Example GitHub Actions workflow
- name: Security Scan
  run: |
    curl -X POST $API_URL/vulnerability/scan/dependencies \
      -H "Authorization: Bearer $API_TOKEN" \
      -d '{"projectPath": "."}'
```

### Kubernetes Integration
```yaml
# Example security policy
apiVersion: v1
kind: Pod
spec:
  securityContext:
    runAsNonRoot: true
    runAsUser: 1000
```

## Monitoring and Alerting

- Real-time vulnerability detection
- Automated alerting for critical issues
- Security metrics and KPI tracking
- Integration with security monitoring dashboard

## Compliance

The system supports compliance with:
- OWASP Top 10
- CIS Benchmarks
- NIST Cybersecurity Framework
- PCI DSS requirements
- GDPR data protection requirements